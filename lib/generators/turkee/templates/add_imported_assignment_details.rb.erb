require 'mechanical_turk_connection_migration'

class AddImportedAssignmentDetails < MechanicalTurkConnectionMigration

  def self.up
    self.with_connection do
      unless column_exists? :turkee_imported_assignments, :turkee_task_id
        add_column :turkee_imported_assignments, :turkee_task_id, :integer
        add_index :turkee_imported_assignments, :turkee_task_id, :unique => false
      end

      unless column_exists? :turkee_imported_assignments, :worker_id
        add_column :turkee_imported_assignments, :worker_id, :string
      end

      unless column_exists? :turkee_imported_assignments, :result_id
        add_column :turkee_imported_assignments, :result_id, :integer
      end
    end
  end

  def self.down
    self.with_connection do
    	if column_exists? :turkee_imported_assignments, :turkee_task_id
          remove_column :turkee_imported_assignments, :turkee_task_id
          remove_index :turkee_imported_assignments, :turkee_task_id
        end

        if column_exists? :turkee_imported_assignments, :worker_id
          remove_column :turkee_imported_assignments, :worker_id
        end

        if column_exists? :turkee_imported_assignments, :result_id
          remove_column :turkee_imported_assignments, :result_id
        end
    end
  end
end
